# UI Changes - Dynamic Header Row Selection

## Overview

This document illustrates the user interface changes for the dynamic header row selection feature.

## Before vs After

### BEFORE: Old Interface

The old interface only allowed specifying a start row number for the products file:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©                                 â”‚
â”‚ [Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù] products.xlsx                                  â”‚
â”‚                                                              â”‚
â”‚ Ø±Ù‚Ù… Ø§Ù„ØµÙ Ø§Ù„Ø°ÙŠ ØªØ¨Ø¯Ø£ Ù…Ù†Ù‡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª                             â”‚
â”‚ [Input: 9]                                                   â”‚
â”‚ Ø§Ù„ØµÙ Ø§Ù„Ø°ÙŠ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† ÙÙŠ Ù…Ù„Ù Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª (Ù…Ø«Ù„Ø§Ù‹: 9...) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Limitations**:

- No visual preview of the file
- Manual input prone to errors
- Only for products file
- Main file assumed header at row 2

---

### AFTER: New Interface

The new interface provides visual preview and dropdown selection for BOTH files:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ                                                    â”‚
â”‚ [Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù] main_file.xlsx                                             â”‚
â”‚                                                                           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ Ø­Ø¯Ø¯ Ø§Ù„ØµÙ Ø§Ù„Ø°ÙŠ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† (Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ)                â”‚   â”‚
â”‚ â”‚ [Dropdown: -- Ø§Ø®ØªØ± Ø±Ù‚Ù… Ø§Ù„ØµÙ -- â–¼]                                 â”‚   â”‚
â”‚ â”‚         â”œâ”€ Ø§Ù„ØµÙ 1                                                  â”‚   â”‚
â”‚ â”‚         â”œâ”€ Ø§Ù„ØµÙ 2                                                  â”‚   â”‚
â”‚ â”‚         â”œâ”€ Ø§Ù„ØµÙ 3                                                  â”‚   â”‚
â”‚ â”‚         â””â”€ ... Ø§Ù„ØµÙ 15                                             â”‚   â”‚
â”‚ â”‚                                                                     â”‚   â”‚
â”‚ â”‚ âš ï¸ ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØµÙ Ø§Ù„Ø°ÙŠ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ù‚Ø¨Ù„ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©        â”‚   â”‚
â”‚ â”‚                                                                     â”‚   â”‚
â”‚ â”‚ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø£ÙˆÙ„ 15 ØµÙ:                                                 â”‚   â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚ â”‚ â”‚ #  â”‚ Ø¹Ù…ÙˆØ¯ 1    â”‚ Ø¹Ù…ÙˆØ¯ 2    â”‚ Ø¹Ù…ÙˆØ¯ 3    â”‚ Ø¹Ù…ÙˆØ¯ 4    â”‚        â”‚  â”‚   â”‚
â”‚ â”‚ â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚  â”‚   â”‚
â”‚ â”‚ â”‚ 1  â”‚ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†  â”‚ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†  â”‚ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†  â”‚ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†  â”‚        â”‚  â”‚   â”‚
â”‚ â”‚ â”‚ 2  â”‚ Ø±Ù‚Ù…       â”‚ Ø§Ù„Ø§Ø³Ù…     â”‚ Ø§Ù„Ø³Ø¹Ø±     â”‚ Ø§Ù„ÙƒÙ…ÙŠØ©    â”‚ â—„â”€ SELECTEDâ”‚
â”‚ â”‚ â”‚ 3  â”‚ 001       â”‚ Ù…Ù†ØªØ¬ Ø£    â”‚ 100       â”‚ 50        â”‚        â”‚  â”‚   â”‚
â”‚ â”‚ â”‚ 4  â”‚ 002       â”‚ Ù…Ù†ØªØ¬ Ø¨    â”‚ 200       â”‚ 30        â”‚        â”‚  â”‚   â”‚
â”‚ â”‚ â”‚ 5  â”‚ 003       â”‚ Ù…Ù†ØªØ¬ Ø¬    â”‚ 150       â”‚ 20        â”‚        â”‚  â”‚   â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©                                             â”‚
â”‚ [Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù] products.xlsx                                              â”‚
â”‚                                                                           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ Ø­Ø¯Ø¯ Ø§Ù„ØµÙ Ø§Ù„Ø°ÙŠ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† (Ù…Ù„Ù Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª)                  â”‚   â”‚
â”‚ â”‚ [Dropdown: Ø§Ù„ØµÙ 9 â–¼]                                               â”‚   â”‚
â”‚ â”‚                                                                     â”‚   â”‚
â”‚ â”‚ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø£ÙˆÙ„ 15 ØµÙ:                                                 â”‚   â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚ â”‚ â”‚ #  â”‚ Ø¹Ù…ÙˆØ¯ 1    â”‚ Ø¹Ù…ÙˆØ¯ 2    â”‚ Ø¹Ù…ÙˆØ¯ 3    â”‚ Ø¹Ù…ÙˆØ¯ 4    â”‚        â”‚  â”‚   â”‚
â”‚ â”‚ â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚  â”‚   â”‚
â”‚ â”‚ â”‚ 1  â”‚ ØµÙ ÙØ§Ø±Øº 1 â”‚           â”‚           â”‚           â”‚        â”‚  â”‚   â”‚
â”‚ â”‚ â”‚ 2  â”‚ ØµÙ ÙØ§Ø±Øº 2 â”‚           â”‚           â”‚           â”‚        â”‚  â”‚   â”‚
â”‚ â”‚ â”‚ ... (rows 3-8 omitted)                             â”‚        â”‚  â”‚   â”‚
â”‚ â”‚ â”‚ 9  â”‚ Ø±Ù‚Ù…       â”‚ Ø§Ù„Ø§Ø³Ù…     â”‚ Ø§Ù„Ø³Ø¹Ø±     â”‚ Ø§Ù„ÙƒÙ…ÙŠØ©    â”‚ â—„â”€ SELECTEDâ”‚
â”‚ â”‚ â”‚ 10 â”‚ 001       â”‚ Ù…Ù†ØªØ¬ Ø£    â”‚ 100       â”‚ 50        â”‚        â”‚  â”‚   â”‚
â”‚ â”‚ â”‚ 11 â”‚ 002       â”‚ Ù…Ù†ØªØ¬ Ø¨    â”‚ 200       â”‚ 30        â”‚        â”‚  â”‚   â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                           â”‚
â”‚ ğŸ’¡ Ù†ØµÙŠØ­Ø©: Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ù„ÙÙƒ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± Ù…Ù†Ø¸Ù…Ø©...                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Improvements**:

- âœ… Visual preview of first 15 rows
- âœ… Dropdown selection (no manual input errors)
- âœ… Works for BOTH main and products files
- âœ… Selected row highlighted in preview
- âœ… Validation messages guide the user
- âœ… Tip message for messy files

---

## Preview Section Details

### Preview Table Features

1. **Row Numbering**: Shows Excel row numbers (1-based)
2. **Row Highlighting**: Selected header row has blue background
3. **Column Display**: Shows first 5 columns of each row
4. **Truncation**: Shows first 15 characters of each cell
5. **Scrollable**: Can scroll horizontally if many columns

### Visual Indicators

```
Normal Row:     â”‚ 3  â”‚ 001       â”‚ Ù…Ù†ØªØ¬ Ø£    â”‚ 100       â”‚ 50        â”‚
                â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Header Row:     â”‚ 2  â”‚ Ø±Ù‚Ù…       â”‚ Ø§Ù„Ø§Ø³Ù…     â”‚ Ø§Ù„Ø³Ø¹Ø±     â”‚ Ø§Ù„ÙƒÙ…ÙŠØ©    â”‚ â—„â”€ SELECTED
                â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ BLUE BACKGROUND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```

---

## Updated Main Page Preview

After selecting header rows, the main page shows updated previews:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ             â”‚  Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Shows data with selected header] â”‚ [Shows data with selected header]  â”‚
â”‚                                    â”‚                                    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ Ø±Ù‚Ù…  â”‚ Ø§Ù„Ø§Ø³Ù… â”‚ Ø§Ù„Ø³Ø¹Ø± â”‚ ... â”‚  â”‚ â”‚ Ø±Ù‚Ù…  â”‚ Ø§Ù„Ø§Ø³Ù… â”‚ Ø§Ù„Ø³Ø¹Ø± â”‚ ... â”‚   â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤  â”‚ â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤   â”‚
â”‚ â”‚ 001  â”‚ Ù…Ù†ØªØ¬ Ø£â”‚ 100   â”‚ ... â”‚  â”‚ â”‚ 001  â”‚ Ù…Ù†ØªØ¬ Ø£â”‚ 100   â”‚ ... â”‚   â”‚
â”‚ â”‚ 002  â”‚ Ù…Ù†ØªØ¬ Ø¨â”‚ 200   â”‚ ... â”‚  â”‚ â”‚ 002  â”‚ Ù…Ù†ØªØ¬ Ø¨â”‚ 200   â”‚ ... â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                    â”‚
â”‚ Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† ÙÙŠ Ø§Ù„ØµÙ 2        â”‚ Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† ÙÙŠ Ø§Ù„ØµÙ 9        â”‚
â”‚ ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¨Ø¯Ø£ Ù…Ù† Ø§Ù„ØµÙ 3          â”‚ ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¨Ø¯Ø£ Ù…Ù† Ø§Ù„ØµÙ 10         â”‚
â”‚ Ø§Ù„ØµÙÙˆÙ Ø£Ø¹Ù„Ø§Ù‡ Ø³ÙŠØªÙ… Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„ÙŠÙ‡Ø§    â”‚                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Button States

### Disabled State (Before Header Selection)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              â”‚
â”‚         [ÙØªØ­ Ø£Ø¯Ø§Ø© Ù…Ø·Ø§Ø¨Ù‚Ø© Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©] (DISABLED - GRAY)         â”‚
â”‚                                                              â”‚
â”‚  âš ï¸ ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØµÙ Ø§Ù„Ø°ÙŠ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ù‚Ø¨Ù„ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Enabled State (After Header Selection)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              â”‚
â”‚         [ÙØªØ­ Ø£Ø¯Ø§Ø© Ù…Ø·Ø§Ø¨Ù‚Ø© Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©] (ENABLED - GREEN)         â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Column Mapper Screen

No visual changes to the column mapper, but it now uses the selected header rows:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ          â”‚  Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Headers from selected row]   â”‚  [Headers from selected row]    â”‚
â”‚                               â”‚                                 â”‚
â”‚ Ø±Ù‚Ù… Ø§Ù„Ù…Ù†ØªØ¬ *                 â”‚  â€¢ Ø±Ù‚Ù… Ø§Ù„Ù…Ù†ØªØ¬                   â”‚
â”‚ [Dropdown â–¼]                  â”‚  â€¢ Ø§Ù„Ø§Ø³Ù…                        â”‚
â”‚                               â”‚  â€¢ Ø§Ù„Ø³Ø¹Ø±                        â”‚
â”‚ Ø£Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ *                 â”‚  â€¢ Ø§Ù„ÙƒÙ…ÙŠØ©                       â”‚
â”‚ [Dropdown â–¼]                  â”‚  â€¢ Ø§Ù„ÙˆØµÙ                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Color Coding

Throughout the interface:

- ğŸ”µ **Blue**: Selected/Active header row
- ğŸŸ¡ **Yellow**: Warning messages (e.g., rows before header preserved)
- ğŸ”´ **Red**: Error messages (e.g., header not selected)
- ğŸŸ¢ **Green**: Success actions (e.g., enabled buttons)
- âš« **Gray**: Disabled states

---

## Responsive Design

The interface adapts to different screen sizes:

### Desktop View (Wide)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Main File                    â”‚  Products File                 â”‚
â”‚  [Preview with 5+ columns]    â”‚  [Preview with 5+ columns]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Mobile/Narrow View

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Main File             â”‚
â”‚  [Preview 3 columns]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Products File         â”‚
â”‚  [Preview 3 columns]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Accessibility Features

1. **Labels**: All form elements have proper Arabic labels
2. **Validation**: Clear error messages in Arabic
3. **Visual Feedback**: Highlighted rows show which is selected
4. **Tooltips**: Helpful messages explain what to do
5. **Keyboard Navigation**: Dropdowns are keyboard accessible

---

## User Flow

```
1. Select Main File
   â†“
2. See Preview (15 rows)
   â†“
3. Select Header Row from Dropdown
   â†“ (Selected row highlighted in blue)
4. Select Products File
   â†“
5. See Preview (15 rows)
   â†“
6. Select Header Row from Dropdown
   â†“ (Selected row highlighted in blue)
7. Both header rows selected?
   â”œâ”€ No â†’ Button disabled, show warning
   â””â”€ Yes â†’ Button enabled
              â†“
              Click "ÙØªØ­ Ø£Ø¯Ø§Ø© Ù…Ø·Ø§Ø¨Ù‚Ø© Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©"
              â†“
              Proceed to Column Mapping
```

---

## Edge Cases Handled

### Case 1: File with < 15 Rows

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ø­Ø¯Ø¯ Ø§Ù„ØµÙ Ø§Ù„Ø°ÙŠ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†  â”‚
â”‚ [Dropdown: -- Ø§Ø®ØªØ± Ø±Ù‚Ù… Ø§Ù„ØµÙ -- â–¼] â”‚
â”‚         â”œâ”€ Ø§Ù„ØµÙ 1                  â”‚
â”‚         â”œâ”€ Ø§Ù„ØµÙ 2                  â”‚
â”‚         â””â”€ Ø§Ù„ØµÙ 8  â† Only 8 rows! â”‚
â”‚                                    â”‚
â”‚ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø£ÙˆÙ„ 8 ØµÙ:                  â”‚
â”‚ (Shows only available rows)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Case 2: No File Selected

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ              â”‚
â”‚ [Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù]                       â”‚
â”‚                                    â”‚
â”‚ (No preview shown)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Case 3: Large File (> 15 Rows)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø£ÙˆÙ„ 15 ØµÙ:                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ 1  â”‚ Data...                 â”‚   â”‚
â”‚ â”‚ 2  â”‚ Data...                 â”‚   â”‚
â”‚ â”‚ ... (rows 3-14)              â”‚   â”‚
â”‚ â”‚ 15 â”‚ Data...                 â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚
â”‚ Ø¹Ø±Ø¶ Ø£ÙˆÙ„ 15 ØµÙ Ù…Ù† Ø¥Ø¬Ù…Ø§Ù„ÙŠ 1000 ØµÙ  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Summary of UI Improvements

| Feature              | Before          | After                |
| -------------------- | --------------- | -------------------- |
| Visual Preview       | âŒ No           | âœ… Yes (15 rows)     |
| Header Selection     | âŒ Manual input | âœ… Dropdown          |
| Main File Header     | âŒ Hardcoded    | âœ… User selects      |
| Products File Header | âš ï¸ Manual input | âœ… Dropdown          |
| Validation           | âš ï¸ Minimal      | âœ… Comprehensive     |
| Visual Feedback      | âŒ None         | âœ… Highlighted row   |
| Error Prevention     | âš ï¸ Limited      | âœ… Strong validation |
| RTL Support          | âœ… Yes          | âœ… Yes (maintained)  |

---

## Conclusion

The new UI provides a much more user-friendly experience for selecting header rows, with visual feedback, validation, and support for both files. Users can now handle Excel files with non-standard header positions with confidence.

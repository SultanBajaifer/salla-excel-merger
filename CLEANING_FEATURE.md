# ููุฒุฉ ุชูุธูู ูููุงุช Excel (Excel Cleaning Feature)

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅุถุงูุฉ ุตูุญุฉ ุฌุฏูุฏุฉ ูู ุงูุชุทุจูู ุชุณูู **"ุชูุธูู ููู ุงูุฅูุณู"** ููุณุงุนุฏุฉ ุงููุณุชุฎุฏููู ุนูู ุชูุธูู ูููุงุช Excel ุชููุงุฆููุง ูุจู ุงุณุชูุฑุงุฏูุง ุฅูู ุงููุธุงู ุงูุฑุฆูุณู.

## ุงููุฏู

ุชูููุฑ ุฃุฏุงุฉ ุชููุงุฆูุฉ ูุชูุธูู ูููุงุช Excel ุจุญูุซ:

- ูุชู ุงูุชุดุงู ุตู ุงูุนูุงููู ุชููุงุฆููุง
- ุฅุฒุงูุฉ ุงูุตููู ูุงูุฃุนูุฏุฉ ุงููุงุฑุบุฉ
- ุญุฐู ุฃู ูุตูุต ุฃู ุจูุงูุงุช ูุตููุฉ ููู ุตู ุงูุนูุงููู
- ุชูุธูู ุงููุณุงูุงุช ูุงูุฃุณุทุฑ ุงูุฌุฏูุฏุฉ ูู ุงูููู

## ุงููููุงุช ุงููุถุงูุฉ/ุงููุนุฏูุฉ

### ูููุงุช ุฌุฏูุฏุฉ

1. **`src/renderer/src/components/CleaningPage.tsx`**
   - ุตูุญุฉ React ูุงููุฉ ูุชูุธูู ุงููููุงุช
   - ูุงุฌูุฉ ูุณุชุฎุฏู ุนุฑุจูุฉ
   - ูุนุงููุฉ ุงูุจูุงูุงุช ุงูููุธูุฉ
   - ูุคุดุฑ ุชุญููู ุฃุซูุงุก ุงููุนุงูุฌุฉ

2. **`scripts/clean_excel.py`**
   - ุณูุฑูุจุช Python ูุชูุธูู ูููุงุช Excel
   - ูุณุชุฎุฏู pandas ู openpyxl ููุนุงูุฌุฉ ุฃูุซุฑ ููุฉ
   - ุฏุงูุฉ `clean_excel()` ูุชูุธูู ุจูุงูุงุช Excel
   - ุฏุงูุฉ ูุงูุชุดุงู ุตู ุงูุนูุงููู ุชููุงุฆููุง

3. **`CLEANING_FEATURE.md`**
   - ูุซุงุฆู ุดุงููุฉ ููููุฒุฉ ุงูุฌุฏูุฏุฉ

### ูููุงุช ูุนุฏูุฉ

1. **`src/main/index.ts`**
   - ุฅุถุงูุฉ IPC handler ุฌุฏูุฏ: `clean-excel-file`
   - ุชูููุฐ ุณูุฑูุจุช Python ูุชูุธูู ุงููููุงุช
   - ุงุณุชุฎุฏุงู `execFile` ูุชุดุบูู ุงูุณูุฑูุจุช
   - ุญูุธ ุงูููู ุงูููุธู ุจุตูุบุฉ `filename_cleaned.xlsx`

2. **`src/preload/index.ts`** ู **`src/preload/index.d.ts`**
   - ุฅุถุงูุฉ API ุฌุฏูุฏ: `cleanExcelFile(filePath)`
   - ุชุนุฑูู TypeScript ููุฏุงูุฉ ุงูุฌุฏูุฏุฉ

3. **`src/renderer/src/store/useAppStore.ts`**
   - ุฅุถุงูุฉ view ุฌุฏูุฏ: `'cleaning'`
   - ุฅุถุงูุฉ state ูููููุงุช ููุฏ ุงูุชูุธูู:
     - `cleaningFilePath`
     - `cleaningFileData`
     - `cleanedFilePath`

4. **`src/renderer/src/App.tsx`**
   - ุฅุถุงูุฉ ุฒุฑ ููุงูุชูุงู ุฅูู ุตูุญุฉ ุงูุชูุธูู
   - ุฅุถุงูุฉ view ููุตูุญุฉ ุงูุฌุฏูุฏุฉ
   - ุฅุถุงูุฉ ุฑุณุงูุฉ ุชูุฌูููุฉ ูููุณุชุฎุฏููู

5. **`README.md`**
   - ุชุญุฏูุซ ูุณู ุงููููุฒุงุช
   - ุฅุถุงูุฉ ุฏููู ุงุณุชุฎุฏุงู ูุตูุญุฉ ุงูุชูุธูู
   - ุชุญุฏูุซ ุจููุฉ ุงููุดุฑูุน

6. **`FEATURES.md`**
   - ุฅุถุงูุฉ ูุณู ูุงูู ุนู ููุฒุฉ ุงูุชูุธูู
   - ุดุฑุญ ุชูุตููู ููููุทู ุงููููุฐ

## ููุทู ุงูุชูุธูู (Python Script)

### 1. ุงูุชุดุงู ุตู ุงูุนูุงููู

```python
# Find the first row with at least 3 non-empty cells (header row)
header_row_idx = None
for i, row in df.iterrows():
    non_empty_count = row.count()
    if non_empty_count >= 3:
        header_row_idx = i
        break
```

ุงูุณูุฑูุจุช Python ูุจุญุซ ุนู ุฃูู ุตู ูุญุชูู ุนูู 3 ุฎูุงูุง ุบูุฑ ูุงุฑุบุฉ ุนูู ุงูุฃูู ููุนุชุจุฑู ุตู ุงูุนูุงููู.

### 2. ุชูุธูู ุงูููู

```python
# Clean all cell values: trim whitespace and replace newlines
df = df.map(lambda x: str(x).strip().replace('\r', ' ').replace('\n', ' ') if isinstance(x, str) else x)
```

- ุฅุฒุงูุฉ ุงููุณุงูุงุช ูู ุงูุจุฏุงูุฉ ูุงูููุงูุฉ
- ุงุณุชุจุฏุงู ุงูุฃุณุทุฑ ุงูุฌุฏูุฏุฉ (`\r`, `\n`) ุจูุณุงูุฉ ูุงุญุฏุฉ

### 3. ุฅุฒุงูุฉ ุงูุตููู ุงููุงุฑุบุฉ

```python
# Drop completely empty rows
df = df.dropna(how='all', axis=0)
```

ูุชู ุญุฐู ุฌููุน ุงูุตููู ุงูุชู ูุง ุชุญุชูู ุนูู ุฃู ุจูุงูุงุช.

### 4. ุฅุฒุงูุฉ ุงูุฃุนูุฏุฉ ุงููุงุฑุบุฉ

```python
# Drop completely empty columns
df = df.dropna(how='all', axis=1)
```

ูุชู ุญุฐู ุฌููุน ุงูุฃุนูุฏุฉ ุงูุชู ูุง ุชุญุชูู ุนูู ุฃู ุจูุงูุงุช.

### 5. ููุงุฐุง Pythonุ

ุงุณุชุฎุฏุงู pandas ู openpyxl ูููุฑ:

- ูุนุงูุฌุฉ ุฃูุซุฑ ููุฉ ูููููุงุช ุงููุนูุฏุฉ
- ุฏุนู ุฃูุถู ููุฎูุงูุง ุงููุฏูุฌุฉ
- ูุนุงูุฌุฉ ุฃุฏู ููุชูุณููุงุช ุงููุฎุชููุฉ
- ุฃุฏุงุก ุฃูุถู ูุน ุงููููุงุช ุงููุจูุฑุฉ

## ูุงุฌูุฉ ุงููุณุชุฎุฏู

### ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ

- ุฒุฑ ุจุงุฑุฒ: **"ุชูุธูู ููู ุงูุฅูุณู"** (ููู ุจููุณุฌู)
- ูุต ุชูุถูุญู: "ูู ูุฏูู ููู ุฅูุณู ูุญุชุงุฌ ุฅูู ุชูุธูู ูุจู ุงููุนุงูุฌุฉุ"

### ุตูุญุฉ ุงูุชูุธูู

1. **ุฒุฑ ุงูุนูุฏุฉ**: ููุฑุฌูุน ุฅูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ
2. **ุงูุนููุงู**: "ุชูุธูู ููู ุงูุฅูุณู"
3. **ุงููุตู**: ุดุฑุญ ูุฎุชุตุฑ ููุธููุฉ ุงูุฃุฏุงุฉ
4. **ุฒุฑ ุงุฎุชูุงุฑ ููู**: ูุฑูุน ููู Excel
5. **ุฒุฑ ุชูุธูู ุงูููู**: ูุจุฏุก ุนูููุฉ ุงูุชูุธูู
6. **ูุคุดุฑ ุงูุชุญููู**: "ุฌุงุฑู ุชูุธูู ุงูููู..."
7. **ุฌุฏูู ุงููุนุงููุฉ**: ุนุฑุถ ุงูุจูุงูุงุช ุงูููุธูุฉ (ุฃูู 10 ุตููู)
8. **ุฃุฒุฑุงุฑ ุงูุฅุฌุฑุงุกุงุช**:
   - "ุนุฑุถ ูููุน ุงูููู ุงูููุธู"
   - "ุชูุธูู ููู ุขุฎุฑ"
9. **ุฑุณุงูุฉ ูุฌุงุญ**: ุชุนุฑุถ ูุณุงุฑ ุงูููู ุงูููุธู

## ุฑุณุงูุฉ ุชูุฌูููุฉ

ุนูุฏ ุงุณุชุฎุฏุงู ููุฒุฉ "ุฑูู ุงูุตู ุงูุฐู ุชุจุฏุฃ ููู ุงูุจูุงูุงุช" ูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉุ ูุธูุฑ ูููุณุชุฎุฏู ุฑุณุงูุฉ:

> ๐ก ูุตูุญุฉ: ุฅุฐุง ูุงู ูููู ูุญุชูู ุนูู ุจูุงูุงุช ุบูุฑ ููุธูุฉ ุฃู ุตููู ูุงุฑุบุฉ ูู ุงูุฃุนููุ ููููู ุงุณุชุฎุฏุงู ุฃุฏุงุฉ "ุชูุธูู ููู ุงูุฅูุณู" ูุชูุธููู ุชููุงุฆููุง ุฃููุงู. ูุฐุง ุณูุฌุนู ุงูุจูุงูุงุช ุชุจุฏุฃ ูุจุงุดุฑุฉ ูู ุงูุตู ุงูุฃูู.

## ูุซุงู ุนูู ุงูุชูุธูู

### ูุจู ุงูุชูุธูู:

```
Row 1: ["This is some title text"]
Row 2: []
Row 3: ["More metadata here"]
Row 4: []
Row 5: ["Product Name", "Price", "Quantity", "", "Description", "SKU"]
Row 6: ["Product A\nwith newline", 100, 50, null, "  Description  ", "SKU001"]
Row 7: ["", "", "", "", "", ""]
Row 8: ["Product B", 200, 30, "", "Another product", "SKU002"]
```

### ุจุนุฏ ุงูุชูุธูู:

```
Row 1: ["Product Name", "Price", "Quantity", "Description", "SKU"]
Row 2: ["Product A with newline", 100, 50, "Description", "SKU001"]
Row 3: ["Product B", 200, 30, "Another product", "SKU002"]
```

## ุงูููุงุฆุฏ

โ **ุชูุธูู ุชููุงุฆู**: ูุง ุญุงุฌุฉ ููุชูุธูู ุงููุฏูู ูู Excel
โ **ุงูุชุดุงู ุฐูู**: ููุชุดู ุตู ุงูุนูุงููู ุชููุงุฆููุง
โ **ุฅุฒุงูุฉ ุงูุจูุงูุงุช ุบูุฑ ุงูุถุฑูุฑูุฉ**: ุตููู ูุฃุนูุฏุฉ ูุงุฑุบุฉ
โ **ุชูุธูู ุงูููู**: ุฅุฒุงูุฉ ุงููุณุงูุงุช ูุงูุฃุณุทุฑ ุงูุฌุฏูุฏุฉ
โ **ุณูููุฉ ุงูุงุณุชุฎุฏุงู**: ูุงุฌูุฉ ุจุณูุทุฉ ููุงุถุญุฉ
โ **ูุนุงููุฉ ูุจุงุดุฑุฉ**: ุนุฑุถ ุงููุชูุฌุฉ ูุจู ุงูุงุณุชุฎุฏุงู

## ุงูุฃูุงู

- ุชู ูุญุต ุงูููุฏ ุจุงุณุชุฎุฏุงู CodeQL
- ูุง ุชูุฌุฏ ุซุบุฑุงุช ุฃูููุฉ (0 alerts)
- ุฌููุน ุงููุฏุฎูุงุช ุชุชู ูุนุงูุฌุชูุง ุจุฃูุงู

## ุงูุงุฎุชุจุงุฑ

ุชู ุงุฎุชุจุงุฑ ุงูููุฒุฉ ุนูู:

- ูููุงุช Excel ุจุตูุบุฉ `.xlsx`
- ูููุงุช ูุน ุตููู ูุงุฑุบุฉ ูุชุนุฏุฏุฉ
- ูููุงุช ูุน ุจูุงูุงุช ูุตููุฉ ูู ุงูุฃุนูู
- ูููุงุช ูุน ุฃุนูุฏุฉ ูุงุฑุบุฉ
- ูููุงุช ูุน ููู ุชุญุชูู ุนูู ุฃุณุทุฑ ุฌุฏูุฏุฉ ููุณุงูุงุช

## ุงูุชูุงูู

- โ TypeScript strict mode
- โ ESLint rules
- โ Prettier formatting
- โ Electron + React + Python
- โ RTL (Right-to-Left) support
- โ Arabic interface

## ุงููุชุทูุจุงุช

### ูููุณุชุฎุฏู ุงูููุงุฆู:

- Python 3.x ูุซุจุช ุนูู ุงููุธุงู
- ููุชุจุฉ pandas (`pip install pandas`)
- ููุชุจุฉ openpyxl (`pip install openpyxl`)

### ููุชุทููุฑ:

- ููุณ ุงููุชุทูุจุงุช ุฃุนูุงู
- Node.js 18+
- npm

## ููุงุญุธุงุช ุงูุชุทููุฑ

1. ุงูููู ุงูููุธู ููุญูุธ ุจุตูุบุฉ `filename_cleaned.xlsx` ูู ููุณ ุงููุฌูุฏ
2. ุงูุณูุฑูุจุช Python ูุชู ุชุถูููู ูู ุงูุชุทุจูู ุนุจุฑ `extraResources` ูู electron-builder
3. ุงูููุฒุฉ ูุง ุชุนุฏู ุงูููู ุงูุฃุตูู
4. ูููู ุงุณุชุฎุฏุงู ุงูููู ุงูููุธู ูุจุงุดุฑุฉ ูู ุนูููุฉ ุงูุฏูุฌ
5. ูู ุญุงูุฉ ูุดู Pythonุ ูุชู ุนุฑุถ ุฑุณุงูุฉ ุฎุทุฃ ูุงุถุญุฉ ูููุณุชุฎุฏู

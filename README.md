# دمج ملفات Excel لمتجر سلة (Salla Excel Merger)

تطبيق سطح مكتب احترافي لدمج ملفات Excel، مبني باستخدام Electron و React و TypeScript.

## 🚀 المميزات

- **واجهة عربية كاملة** - جميع النصوص بالعربية مع تخطيط RTL
- **تنظيف ملفات Excel** - أداة تلقائية لتنظيف الملفات وإزالة البيانات غير الضرورية
- **اختيار الملفات** - واجهة سهلة لاختيار ملفات Excel
- **معاينة البيانات** - عرض أول 5 صفوف من كل ملف
- **مطابقة الأعمدة** - مطابقة مرنة بين أعمدة الملفات
- **القيم اليدوية** - إدخال قيم افتراضية للأعمدة غير المطابقة
- **معاينة الدمج** - عرض البيانات المدمجة قبل الحفظ
- **حفظ الملف** - حفظ الملف المدمج بصيغة Excel

## 📦 التقنيات المستخدمة

- **Electron 38** - إطار عمل تطبيقات سطح المكتب
- **React 19** - مكتبة واجهة المستخدم
- **TypeScript 5** - للأمان في الأنواع
- **Vite 7** - أداة بناء سريعة
- **TailwindCSS 4** - أنماط CSS
- **Zustand 5** - إدارة الحالة
- **ExcelJS 4** - معالجة ملفات Excel
- **Python 3** + pandas + openpyxl - تنظيف ملفات Excel

## 🛠️ إعداد المشروع

### المتطلبات

- Node.js 18+ و npm
- Python 3.x مع المكتبات: pandas, openpyxl

### تثبيت المكتبات

```bash
# تثبيت مكتبات Node.js
npm install

# تثبيت مكتبات Python المطلوبة لتنظيف الملفات
pip install pandas openpyxl
```

### التطوير

تشغيل التطبيق في وضع التطوير مع إعادة التحميل التلقائي:

```bash
npm run dev
```

### البناء

بناء التطبيق للإنتاج:

```bash
# لنظام Windows
npm run build:win

# لنظام macOS
npm run build:mac

# لنظام Linux
npm run build:linux
```

### أوامر أخرى

```bash
# فحص الأنواع
npm run typecheck

# فحص الكود
npm run lint

# تنسيق الكود
npm run format
```

## 📁 بنية المشروع

```
salla-excel-merger/
├── src/
│   ├── main/                    # عملية Electron الرئيسية
│   │   └── index.ts            # معالجات IPC وقراءة/كتابة/تنظيف Excel
│   ├── preload/                 # سكريبتات Preload
│   │   ├── index.ts            # تعريف APIs
│   │   └── index.d.ts          # TypeScript definitions
│   └── renderer/                # تطبيق React
│       ├── index.html          # HTML مع lang="ar" و dir="rtl"
│       └── src/
│           ├── App.tsx          # المكون الرئيسي مع 4 واجهات
│           ├── main.tsx         # نقطة دخول React
│           ├── index.css        # الأنماط العامة مع RTL
│           ├── components/      # مكونات React
│           │   ├── FileSelector.tsx       # مكون اختيار الملفات
│           │   ├── ColumnMapper.tsx       # أداة مطابقة الأعمدة
│           │   ├── PreviewTable.tsx       # جدول معاينة البيانات
│           │   ├── CleaningPage.tsx       # صفحة تنظيف ملفات Excel
│           │   └── SaveButton.tsx         # زر الحفظ
│           ├── services/        # منطق العمل
│           │   ├── excelService.ts       # خدمات Excel (موجود لكن غير مستخدم)
│           │   └── excelCleaner.ts       # منطق تنظيف ملفات Excel
│           └── store/           # إدارة الحالة
│               └── useAppStore.ts        # Zustand store
├── electron.vite.config.ts      # إعدادات Vite
├── electron-builder.yml         # إعدادات Electron builder
└── package.json
```

## 🎯 الحالة الحالية

✅ **بنية المشروع** - تم الإعداد والتنظيم بالكامل
✅ **واجهة المستخدم** - جميع النصوص بالعربية مع RTL
✅ **تنظيف ملفات Excel** - أداة تلقائية لتنظيف الملفات وإزالة البيانات غير الضرورية
✅ **اختيار الملفات** - تم التنفيذ عبر IPC
✅ **قراءة ملفات Excel** - تم التنفيذ في main process
✅ **معاينة البيانات** - عرض أول 5 صفوف
✅ **مطابقة الأعمدة** - تم التنفيذ مع دعم القيم اليدوية
✅ **دمج البيانات** - تم التنفيذ مع معاينة
✅ **حفظ الملف** - تم التنفيذ مع اسم ملف عربي
✅ **إدارة الحالة** - Zustand مُعد ويعمل
✅ **معالجة الأخطاء** - جميع الرسائل بالعربية

## 🖼️ الواجهات

### الواجهة الرئيسية

- زر الانتقال لصفحة تنظيف ملفات Excel
- اختيار الملف الرئيسي
- اختيار ملف المنتجات الجديدة
- معاينة كلا الملفين (أول 5 صفوف)
- الانتقال إلى أداة مطابقة الأعمدة

### واجهة تنظيف ملفات Excel

- رفع ملف Excel للتنظيف
- تنظيف تلقائي للملف (إزالة الصفوف الفارغة والأعمدة والبيانات غير الضرورية)
- معاينة البيانات المنظفة
- تحميل الملف المنظف

### واجهة مطابقة الأعمدة

- مطابقة الأعمدة من المنتجات الجديدة إلى الملف الرئيسي
- تعيين قيم افتراضية يدوية للأعمدة غير المطابقة
- زر عرض النتيجة

### واجهة المعاينة

- عرض معاينة البيانات المدمجة
- حفظ الملف المدمج على القرص

## 💡 كيفية الاستخدام

### تنظيف ملف Excel (اختياري ولكن موصى به)

1. **الانتقال لصفحة التنظيف**
   - من الصفحة الرئيسية، انقر على "تنظيف ملف الإكسل"

2. **رفع وتنظيف الملف**
   - انقر على "اختيار ملف" واختر ملف Excel الذي تريد تنظيفه
   - انقر على "تنظيف الملف"
   - سيقوم النظام تلقائيًا بـ:
     - اكتشاف صف العناوين الأول
     - إزالة الصفوف الفارغة والأعمدة
     - حذف أي نصوص أو بيانات فوق صف العناوين
     - تنظيف المسافات والأسطر الجديدة من القيم

3. **معاينة وتحميل**
   - معاينة البيانات المنظفة في الجدول
   - انقر على "عرض موقع الملف المنظف" لمعرفة مكان حفظ الملف
   - استخدم الملف المنظف في عملية الدمج

### دمج الملفات

1. **اختيار الملفات**
   - انقر على "اختيار الملف الرئيسي" واختر ملف Excel الرئيسي
   - انقر على "اختيار ملف المنتجات الجديدة" واختر ملف المنتجات
   - سيتم عرض معاينة لأول 5 صفوف من كل ملف
   - **نصيحة**: استخدم الملفات المنظفة لنتائج أفضل

2. **مطابقة الأعمدة**
   - انقر على "فتح أداة مطابقة الأعمدة"
   - لكل عمود في الملف الرئيسي، اختر العمود المطابق من المنتجات الجديدة
   - أو اختر "إدخال قيمة يدوياً" وأدخل قيمة افتراضية

3. **معاينة وحفظ**
   - انقر على "عرض النتيجة" لمعاينة البيانات المدمجة
   - إذا كانت النتيجة صحيحة، انقر على "حفظ الملف الرئيسي"
   - اختر مكان الحفظ واسم الملف

## 📝 ترخيص

هذا المشروع خاص وملكي.

## 👨‍💻 التطوير

هذا تطبيق سطح مكتب احترافي مبني لنظام Windows. يتبع الكود أفضل الممارسات مع TypeScript strict mode، وبنية مكونات معيارية، وفصل واضح للمسؤوليات.

### إعداد IDE الموصى به

- [VSCode](https://code.visualstudio.com/)
- [ESLint Extension](https://marketplace.visualstudio.com/items?itemName=dbaeumer.vscode-eslint)
- [Prettier Extension](https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode)
- [TailwindCSS IntelliSense](https://marketplace.visualstudio.com/items?itemName=bradlc.vscode-tailwindcss)


### push release
1- make change on version in pacakge.json
2- git add .
3- git commit -m "chore(release): v${tag}"           
git tag v${tag}                                         
4-git push origin maingit push origin --tags
